(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[43],{4780:function(e,t,s){Promise.resolve().then(s.bind(s,2451))},2451:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return c}});var a=s(7437),i=s(2265);let n="http://Noel-ALB-780957247.ap-south-1.elb.amazonaws.com/api";function c(){let[e,t]=(0,i.useState)([]),[s,c]=(0,i.useState)([]),[d,l]=(0,i.useState)(0),[o,r]=(0,i.useState)(""),[u,h]=(0,i.useState)(0);async function m(){let[e,s]=await Promise.all([fetch("".concat(n,"/products")).then(e=>e.json()),fetch("".concat(n,"/cart"),{credentials:"include"}).then(e=>e.json()).catch(()=>({items:[]}))]);t(e.products||[]),c(s.items||[]);let a=0;for(let t of s.items||[]){let s=(e.products||[]).find(e=>e.id===(t.productId||t.product_id));s&&(a+=s.priceCents*(t.qty||1))}l(a)}async function p(e){await fetch("".concat(n,"/cart/add"),{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({productId:e,qty:1})}),await m()}async function x(e){await fetch("".concat(n,"/cart/remove"),{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({productId:e})}),await m()}async function f(e,t){let a=s.find(t=>(t.productId||t.product_id)===e),i=Math.max(1,t)-(a?a.qty:0);0!==i&&(await fetch("".concat(n,"/cart/add"),{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({productId:e,qty:i})}),await m())}async function j(){let e=await fetch("".concat(n,"/discounts/validate"),{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({code:o})}),t=await e.json();e.ok?h(t.discount_cents||0):(h(0),alert(t.error||"Invalid code"))}return(0,i.useEffect)(()=>{m()},[]),(0,a.jsxs)("section",{className:"container",children:[(0,a.jsxs)("div",{className:"topbar",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"badge",children:"Curated for You"}),(0,a.jsx)("h2",{children:"Elegant Dresses"})]}),(0,a.jsxs)("div",{className:"cart-panel",style:{maxWidth:420,flex:"0 0 420px"},children:[(0,a.jsx)("div",{style:{fontWeight:700,marginBottom:".5rem"},children:"Your Cart"}),(0,a.jsx)("div",{children:0===s.length?(0,a.jsx)("div",{className:"sub",children:"Your cart is empty."}):s.map((e,t)=>{let s=e.productId||e.product_id;return(0,a.jsxs)("div",{className:"row",children:[(0,a.jsxs)("div",{children:["PID ",s," \xd7 ",(0,a.jsx)("input",{type:"number",min:1,defaultValue:e.qty,style:{width:60},onChange:e=>f(s,Number(e.target.value||1))})]}),(0,a.jsx)("div",{children:(0,a.jsx)("button",{className:"btn ghost",onClick:()=>x(s),children:"Remove"})})]},t)})}),(0,a.jsxs)("div",{className:"row",style:{borderBottom:0},children:[(0,a.jsx)("div",{style:{flex:1},children:(0,a.jsx)("input",{className:"input",placeholder:"Promo code",value:o,onChange:e=>r(e.target.value)})}),(0,a.jsx)("button",{className:"btn ghost",onClick:j,style:{marginLeft:8},children:"Apply"})]}),(0,a.jsxs)("div",{className:"total",children:["Subtotal: ₹",(d/100).toFixed(2)]}),(0,a.jsxs)("div",{className:"total",style:{color:u>0?"#22c55e":void 0},children:["Discount: -₹",(u/100).toFixed(2)]}),(0,a.jsxs)("div",{className:"total",children:["Payable: ₹",(Math.max(0,d-u)/100).toFixed(2)]}),(0,a.jsx)("div",{className:"actions",children:(0,a.jsx)("a",{className:"btn",href:"/checkout",children:"Proceed to Checkout"})})]})]}),(0,a.jsx)("div",{className:"grid",children:e.map(e=>(0,a.jsxs)("div",{className:"card",children:[(0,a.jsx)("img",{src:e.imageUrl||"",alt:e.name}),(0,a.jsxs)("div",{className:"pad",children:[(0,a.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,a.jsx)("div",{style:{fontWeight:700},children:e.name}),(0,a.jsxs)("div",{className:"price",children:["₹",(e.priceCents/100).toFixed(2)]})]}),(0,a.jsx)("div",{className:"sub",style:{fontSize:".9rem",margin:".25rem 0 .5rem"},children:e.description||""}),(0,a.jsx)("div",{className:"actions",children:(0,a.jsx)("button",{className:"btn",onClick:()=>p(e.id),children:"Add to cart"})})]})]},e.id))})]})}}},function(e){e.O(0,[971,69,744],function(){return e(e.s=4780)}),_N_E=e.O()}]);